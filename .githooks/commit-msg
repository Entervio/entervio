#!/bin/bash

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# Skip merge commits
if git rev-parse -q --verify MERGE_HEAD >/dev/null 2>&1; then
    exit 0
fi

# Check if this exact commit message already exists in git history
if git log --format=%s | grep -Fxq "$COMMIT_MSG"; then
    echo "Error: This commit message already exists in git history:"
    echo "  \"$COMMIT_MSG\""
    echo ""
    echo "Please use a unique commit message."
    exit 1
fi

exit 0